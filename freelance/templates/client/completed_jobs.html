{% extends 'client/base.html' %}

{% block content %}
<div class="bradcam_area bradcam_bg_1">
    <div class="container">
        <div class="row">
            <div class="col-xl-12">
                <div class="bradcam_text">
                    <h3>Completed Works</h3>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container mt-5">
    <h2 class="text-center">Completed Jobs</h2>
    <table class="table table-striped table-bordered">
        <thead class="thead-dark">
            <tr>
                <th>SL.No./Job ID</th>
                <th>Job Name</th>
                <th>Deadline</th>
                <th>Completed On</th>
                <th>Worker</th>
                <th>Payment Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for job in jobs %}
            <tr>
                <td>{{ forloop.counter }}/{{ job.id }}</td>
                <td>{{ job.job_name }}</td>
                <td>{{ job.deadline}}</td>
                <td>{{ job.completed_at }}</td>
                <td>
                    {% if job.assigned_worker %}
                        {{ job.assigned_worker.candidate.freelancer_name }}
                    {% else %}
                        Not Assigned
                    {% endif %}
                </td>
                <td>
                    {% if job.payment_status == 'paid' %}
                        <span class="text-success">Paid</span>
                    {% else %}
                        <span class="text-danger">Pending</span>
                    {% endif %}
                </td>
                <td>
                    {% if job.payment_status == "pending" %}
                        <a href="{% url 'make_payment' job.id %}" class="btn btn-success btn-sm">Make Payment</a>
                    {% else %}
                        <span class="btn btn-success btn-sm">Payment Completed</span>
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="6" class="text-center">No completed jobs available</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
